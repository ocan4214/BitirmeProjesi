@model BitirmeProjesi.Models.ViewModel.GroupPageViewModel

@{
    ViewBag.Title = "GroupPage";
}

<h2>GroupPage</h2>

@Html.ActionLink("Create a New Chat Room", "CreateGroupChat", new { groupid = Model.groupView.GroupId })
@Html.Hidden("groupId", Model.groupView.GroupId)
<div class="container">

    <div class="row">
        <div class="chatRooms col">
            @foreach (var room in Model.groupView.GroupChats)
            {
                <input type="hidden" id="chatName" value="@room.GroupChatName" />
                <button id="joinBtn" >Sohbete Katıl</button>
                <div id="Chatroom+@room.GroupChatName">



                </div>
            }




        </div>
    </div>














</div>



@section scripts
{
    @Scripts.Render("~/bundles/signalr")
    @Scripts.Render("~/signalr/hubs")
    <script>
        var groupChatHub = $.connection.groupChatHub;

        groupChatHub.client.serverNotification = function (message) { console.log(message); };
        var chatName = $("#chatName").val();
        var groupId = $("#groupId").val();
        $.connection.hub.qs = {
            'groupChatName': chatName };


        $.connection.hub.start().done(function () {

            $("#joinBtn").click(function () {
                groupChatHub.server.joinGroupChat(chatName, groupId);
            });


        }).fail(function () {


            console.log("Hub couldn't start");

        });




    </script>
}







